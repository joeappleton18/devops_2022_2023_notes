<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Week 3: Static Code Analysis (ii)</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/devops_2022_2023_notes/assets/css/0.styles.8b92ebe3.css" as="style"><link rel="preload" href="/devops_2022_2023_notes/assets/js/app.045daadb.js" as="script"><link rel="preload" href="/devops_2022_2023_notes/assets/js/2.9607f3a7.js" as="script"><link rel="preload" href="/devops_2022_2023_notes/assets/js/6.11790a3f.js" as="script"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/10.9fab5e2e.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/11.9fb836c5.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/12.eccc10c7.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/13.970cc596.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/14.0974943f.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/15.f75a52ff.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/16.783f2777.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/17.d3e2f649.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/18.9633f85a.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/19.67034eec.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/20.78c6ae4b.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/21.db627dc0.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/22.edbec955.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/23.b63d38be.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/24.748dc84a.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/25.f52f61d2.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/26.11cbfdfc.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/27.f3c3e734.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/28.a2ac5a28.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/29.40e5e306.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/3.74be171c.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/30.2fb77c40.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/31.a6dcae90.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/32.9f6ba499.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/33.4562c5b9.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/34.6de6f42d.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/35.8ea2ce19.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/36.cc5557a2.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/37.8896c35d.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/38.93e10668.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/39.e30cfa1e.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/4.05692aca.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/40.2746a650.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/5.6fc8f38e.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/7.809e86b6.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/8.8a515d4e.js"><link rel="prefetch" href="/devops_2022_2023_notes/assets/js/9.b13775eb.js">
    <link rel="stylesheet" href="/devops_2022_2023_notes/assets/css/0.styles.8b92ebe3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/devops_2022_2023_notes/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Module Overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/devops_2022_2023_notes/" aria-current="page" class="sidebar-link">Module Introduction (Start Here ‚ñ∂Ô∏è)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Assessments</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/devops_2022_2023_notes/assessment/" class="sidebar-link">Assessment Overview</a></li><li><a href="/devops_2022_2023_notes/assessment/scenario.html" class="sidebar-link">Assessment Scenario</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Side Tutorials</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 1: Introduction to DevOps</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 2: Static Code Analysis (1)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Week 3: Static Code Analysis (2)</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/devops_2022_2023_notes/week-3/lecture.html" class="sidebar-link">Lecture</a></li><li><a href="/devops_2022_2023_notes/week-3/" aria-current="page" class="active sidebar-link">Week 3: Static Code Analysis (ii)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#lesson-dependencies-üî®" class="sidebar-link">Lesson Dependencies üî®</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#task-1-set-up" class="sidebar-link">TASK 1: Set up</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#prettier" class="sidebar-link">Prettier</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#task-1-installing-prettier" class="sidebar-link">TASK 1: Installing Prettier</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#husky" class="sidebar-link">Husky</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#task-2-installing-husky" class="sidebar-link">TASK 2: Installing Husky</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#github-workflows" class="sidebar-link">GitHub Workflows</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#task-3-our-first-workflow" class="sidebar-link">Task 3: Our First Workflow</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#task-4-home-study" class="sidebar-link">Task 4: Home Study</a></li><li class="sidebar-sub-header"><a href="/devops_2022_2023_notes/week-3/#further-reading" class="sidebar-link">Further Reading</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 4: Component Driven Development</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 5: Testing</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 6: Database Testing</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 7: Authentication Testing Strategies and Deployment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 8: CD Strategies</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Week 9: Unit Testing</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/devops_2022_2023_notes/week-9/" class="sidebar-link">Week 9: Unit Testing</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 10: Monitoring and Logging</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 11: Module Wrap Up (assessment support)</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="week-3-static-code-analysis-ii"><a href="#week-3-static-code-analysis-ii" class="header-anchor">#</a> Week 3: Static Code Analysis (ii)</h1> <p><img src="/devops_2022_2023_notes/assets/img/ci-pipeline.c5857f53.png" alt=""></p> <p>This week, we will complete the static analysis rung of the CI pipeline. In doing so, we'll add code formatting to the room-checking sample application. Further, we'll put in place checks to ensure that code that does not comply with our linting and formatting rules does not end up in our codebase.</p> <p>Throughout this week, we will be addressing the following questions:</p> <ol><li>How can we ensure that a team follows a consistent coding standard?</li> <li>How can we enforce these standards?</li> <li>How can we integrate these standards into our CI/CD pipeline?</li> <li>How can I deploy my web applications?</li></ol> <h2 id="lesson-dependencies-üî®"><a href="#lesson-dependencies-üî®" class="header-anchor">#</a> Lesson Dependencies üî®</h2> <ul><li><a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git" target="_blank" rel="noopener noreferrer">You will need to ensure you have the version control tool Git installed<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>You'll need to know the basic Git Commands (e.g., <code>checkout -b</code>, <code>push</code>, and <code>commit</code>)</li></ul></li> <li>While you can use any text editor for this session, I recommend that you install <a href="https://code.visualstudio.com/download" target="_blank" rel="noopener noreferrer">VS Code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="getting-the-week-two-starting-code-base"><a href="#getting-the-week-two-starting-code-base" class="header-anchor">#</a> Getting the week two starting code base</h3> <p>In your command line shell, run:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
<span class="token function">git</span> clone --branch week-3-starter-code https://github.com/joeappleton18/solent-room-finder.git solent-room-finder-week-3

- Navigate into the created  <span class="token variable"><span class="token variable">`</span>solent-room-finder<span class="token variable">`</span></span> folder: <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">cd</span> solent-room-finder-week-3<span class="token variable">`</span></span>
- Install the dependencies: <span class="token variable"><span class="token variable">`</span><span class="token function">npm</span> <span class="token function">install</span><span class="token variable">`</span></span>
- Run the development server: <span class="token variable"><span class="token variable">`</span><span class="token function">npm</span> run dev<span class="token variable">`</span></span>
- Open <span class="token punctuation">[</span>http://localhost:3000<span class="token punctuation">]</span><span class="token punctuation">(</span>http://localhost:3000<span class="token punctuation">)</span> with your browser to see the result.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="task-1-set-up"><a href="#task-1-set-up" class="header-anchor">#</a> TASK 1: Set up</h2> <div class="custom-block warning"><p class="custom-block-title">TASK 1: Set up</p> <p>Follow the steps above to, ensure you have the lesson dependencies set up: including the starting code base.</p></div> <h2 id="prettier"><a href="#prettier" class="header-anchor">#</a> Prettier</h2> <p>Prettier is an opinionated code formatter; however, as you have seen, last week, our linter already formats code (to a degree). It may at first seem similar to a linter; however, on closer inspection, there are some subtle differences:</p> <ul><li><p>Linters are mostly worried about code quality: eg no-unused-vars, no-extra-bind, no-implicit-globals, prefer-promise-reject-error</p></li> <li><p>Prettier prints your whole program from scratch applying only formatting rules: eg: max-len, no-mixed-spaces-and-tabs, keyword-spacing, comma-style. As a developer, you never have to worry about formatting your code again.</p></li></ul> <h2 id="task-1-installing-prettier"><a href="#task-1-installing-prettier" class="header-anchor">#</a> TASK 1: Installing Prettier</h2> <div class="custom-block warning"><p class="custom-block-title">TASK 1: Installing Prettier</p> <p>Let's get going with prettier awesomeness:</p> <ol><li>Install the dependencies: <code>npm install --save-dev eslint-config-prettier prettier</code></li> <li>Notice how we installed <code>eslint-config-prettier</code> along with <code>prettier</code>.
ESlint can do some formatting for us; however, we don't want it to conflict with prettier. The <code>eslint-config-prettier</code> package ensures that only prettier's formatting rules are used. We can use it by adding <code>prettier</code> to the extends array of our <code>eslintrc.json</code> file:</li></ol> <div class="language-json line-numbers-mode"><pre class="language-json"><code>`eslintrc.json`

```JavaScript
<span class="token punctuation">{</span>
  ...
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;next/core-web-vitals&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;eslint:recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugin:@typescript-eslint/recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;prettier&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
 ....
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><blockquote><p><code>eslintrc.json</code>: adding prettier</p></blockquote></blockquote> <ul><li><p>You can now run prettier: <code>npx prettier --write .</code>. This command will automatically fix the formatting in your code.</p></li> <li><p><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode" target="_blank" rel="noopener noreferrer">Like ESlint, there is a VS code plugin for prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Install the plugin.</p></li> <li><p>We can now update our <code>./vscode/settings.json</code> file to auto format on save:</p></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;source.fixAll.eslint&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;source.fixAll.format&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;eslint.validate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;javascript&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;editor.defaultFormatter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;esbenp.prettier-vscode&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><blockquote><p>.vscode/settings.json: these are what my final settings look like</p></blockquote></blockquote> <ul><li>Finally, in your root directory create the following two files: <code>.prettierignore</code> and <code>.prettierrc.json</code>. <code>.prettierrc.json</code> allows us to add custom rules, let's add the following:</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;printWidth&quot;</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token property">&quot;bracketSpacing&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>.prettierrc.json</code>: Prettier already has a solid rule set; above, I am tweaking it to my preferences. <a href="https://prettier.io/playground/" target="_blank" rel="noopener noreferrer">Have a play in the playground if you want to add further rules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h2 id="husky"><a href="#husky" class="header-anchor">#</a> Husky</h2> <p>If you've got this far, you've come a long way: give yourself a pat on the back. However, we are not quite finished. Would it not be nice if we could automatically run checks (e.g., linting, formatting, testing, and type checking) before each commit. This is where Husky comes into play.</p> <p><a href="https://typicode.github.io/husky/#/" target="_blank" rel="noopener noreferrer">According to the developers, &quot;Husky improves your commits and more üê∂ woof! You can use it to lint your commit messages, run tests, lint code, etc... when you commit or push. Husky supports all Git hooks.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="task-2-installing-husky"><a href="#task-2-installing-husky" class="header-anchor">#</a> TASK 2: Installing Husky</h2> <div class="custom-block warning"><p class="custom-block-title">TASK 5: Install Husky</p> <ul><li><p>npx husky-init</p></li> <li><p>npm install</p></li> <li><p>Next, we need to set up some scripts in our package.json file, these will run on each commit:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>
<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span>
	...
	<span class="token property">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier --write .&quot;</span><span class="token punctuation">,</span>
  	<span class="token property">&quot;types&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc&quot;</span><span class="token punctuation">,</span>
	...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><blockquote><blockquote><p><code>package.json</code>: updated rules</p></blockquote></blockquote></blockquote></li> <li><p>Finally, tell Husky which scripts to run in the <code>.husky/pre-commit</code> file. Your file should resemble the below:</p></li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env sh</span>
<span class="token builtin class-name">.</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> -- <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span><span class="token variable">)</span></span>/_/husky.sh&quot;</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;running pre-commit checks&quot;</span>

<span class="token comment">## prettier</span>

<span class="token function">npm</span> run  prettier
<span class="token function">npm</span> run types
<span class="token function">npm</span> run lint
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>Now, when you make a commit the above checks should run. If they fail, your code won't be committed.</li></ul></div> <h2 id="github-workflows"><a href="#github-workflows" class="header-anchor">#</a> GitHub Workflows</h2> <p>A recent addition to GitHub is something known as workflows.</p> <p>According to GitHub, &quot;Workflows are defined in the .github/workflows directory in a repository, and a repository can have multiple workflows, each of which can perform a different set of tasks. For example, you can have one workflow to build and test pull requests, another workflow to deploy your application every time a release is created, and still another workflow that adds a label every time someone opens a new issue.&quot;</p> <p>This is a very exciting prospect; we can use workflows to automate repetitive jobs. Today, we will consider how we can automate our static code checking on both a pull request to our room checker's master branch and a push request to any branch. Moving forward, we can define jobs that build and test our room-checking application. Over the course of a project, this could save you hours of manual, tedious labour.</p> <h2 id="task-3-our-first-workflow"><a href="#task-3-our-first-workflow" class="header-anchor">#</a> Task 3: Our First Workflow</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>‚≠êÔ∏è</p> <p>If you can't push and you are sure you are the only one working on branch you can use: <code>git push origin &lt;branch-name&gt; --force</code></p></div> <div class="custom-block warning"><p class="custom-block-title">TASK 5: Our First Workflow</p> <p>Let's create a workflow that will check the quality of code being committed to our remote repository.</p> <ul><li><a href="https://docs.github.com/en/actions/quickstart" target="_blank" rel="noopener noreferrer">First, read the first page of the GitHub actions documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>In your room finder project, create the <code>.github/workflows/</code> directory to store your workflow files.</li> <li>Create a file in <code>.github/workflows/</code> called <code>main.yaml</code></li> <li>Add the following code to <code>main.yaml</code></li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> Checking Code Quality
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;push&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pull_request&quot;</span><span class="token punctuation">]</span> <span class="token comment">## run on push and pulls</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">eslint</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Run Code Quality Static Checks <span class="token comment">## the name of our job</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">permissions</span><span class="token punctuation">:</span>
      <span class="token key atrule">contents</span><span class="token punctuation">:</span> read
      <span class="token key atrule">security-events</span><span class="token punctuation">:</span> write
      <span class="token key atrule">actions</span><span class="token punctuation">:</span> read <span class="token comment"># only required for a private repository by github/codeql-action/upload-sarif to get the Action run status</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout code
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v3
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install Dev Dependencies
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install <span class="token punctuation">-</span><span class="token punctuation">-</span>only=dev
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Run ESLint
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run lint
        <span class="token key atrule">continue-on-error</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><blockquote><blockquote><p><a href="https://docs.github.com/en/actions/quickstart" target="_blank" rel="noopener noreferrer">To understand what the above code snippet does, read the GitHub actions documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></blockquote> <ul><li>Commit your changes</li> <li>Next, switch to a <code>main</code> branch: <code>git checkout -b main</code></li> <li>Set up a GitHub repository to hold your project, and grab the remote address</li> <li>Remove the existing remote address: <code>git remote remove origin</code></li> <li>Add your repository's remote address: <code>git remote add origin &lt; your address&gt;</code></li> <li>Push to your remote repository: <code>git push origin main</code></li> <li>If all has worked well, there should now be a green tick on the top of your repository:</li></ul> <p><img src="/devops_2022_2023_notes/assets/img/green-tick.443ebe07.png" alt=""></p> <ul><li>You can also verify your job has run by clicking the actions button at the top of your repository:</li></ul> <p><img src="/devops_2022_2023_notes/assets/img/actions.1a106cea.png" alt=""></p> <ol><li>Can you expand <code>main.yaml</code> to also check types and run prettier?</li> <li>Check out a new branch, push to the remote repository, and raise a pull request: you should get a detailed report on the status of the jobs that have run.</li> <li><strong>Bonus Task:</strong> <a href="https://github.com/marketplace?type=actions" target="_blank" rel="noopener noreferrer">GitHub actions has a marketplace of actions we can use<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Can you use the marketplace to create a new job that does something interesting. <a href="https://docs.github.com/en/actions/managing-issues-and-pull-requests/moving-assigned-issues-on-project-boards" target="_blank" rel="noopener noreferrer">This project management example sparked my interest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="https://github.com/marketplace/actions/discord-message-notify" target="_blank" rel="noopener noreferrer">You can also do things like update discord on a pull request<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol></div> <h3 id="task-solutions"><a href="#task-solutions" class="header-anchor">#</a> Task solutions</h3> <blockquote><blockquote><p>Solution corresponding to the task step number. You should attempt the task before you look at the solutions üòÜ.</p></blockquote></blockquote> <details class="custom-block details"><summary>SOLUTION (1) Click me to view the code</summary> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">...</span>
 <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Run Prettier
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run prettier
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Check Types
	<span class="token key atrule">run</span><span class="token punctuation">:</span> npm run types
<span class="token punctuation">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></details> <h2 id="task-4-home-study"><a href="#task-4-home-study" class="header-anchor">#</a> Task 4: Home Study</h2> <p>Using what you have learnt so far:</p> <ul><li>Static checking</li> <li>Automation (Huskey, GitHub Actions)</li></ul> <p>Create a starter Next.js project, and enforce coding standards and type checking: this will be useful for your assessment.</p> <h2 id="further-reading"><a href="#further-reading" class="header-anchor">#</a> Further Reading</h2> <h3 id="typescript"><a href="#typescript" class="header-anchor">#</a> TypeScript</h3> <ul><li><a href="https://www.typescriptlang.org/docs/handbook/intro.html" target="_blank" rel="noopener noreferrer">The TypeScript Hand Book, well worth flicking through‚à´<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="code-formatting-and-linting"><a href="#code-formatting-and-linting" class="header-anchor">#</a> Code Formatting and Linting</h3> <ul><li><a href="https://prettier.io/playground/" target="_blank" rel="noopener noreferrer">Check out all the formatting rules you can use for prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="github-workflows-2"><a href="#github-workflows-2" class="header-anchor">#</a> GitHub Workflows</h3> <ul><li><a href="https://docs.github.com/en/actions/using-workflows/about-workflows" target="_blank" rel="noopener noreferrer">GitHub Workflows<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/devops_2022_2023_notes/week-3/lecture.html" class="prev">
        Lecture
      </a></span> <span class="next"><a href="/devops_2022_2023_notes/week-4/lecture.html">
        Lecture
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/devops_2022_2023_notes/assets/js/app.045daadb.js" defer></script><script src="/devops_2022_2023_notes/assets/js/2.9607f3a7.js" defer></script><script src="/devops_2022_2023_notes/assets/js/6.11790a3f.js" defer></script>
  </body>
</html>
